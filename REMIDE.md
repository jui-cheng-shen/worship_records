# 大林教會聚會記錄系統使用手冊

## 系統功能概述
本系統為大林真耶穌教會聚會記錄管理系統，提供完整的聚會記錄管理功能，包含資料輸入、查詢、統計和修改等功能。

### 1. 人員分類統計功能
- **主內信徒**：分別記錄弟兄人數、姊妹人數，自動計算主內總人數  
- **慕道者**：分別記錄男性慕道者人數、女性慕道者人數，自動計算慕道者總人數  
- **自動化計算**：系統自動計算各類總數，不需人工加總

### 2. 聚會資料分類
- **聚會類別**：
  - 安息日聚會
  - 晚間聚會
  - 家庭聚會
  - 唱詩祈禱會
  - 團契聚會
  - 特別聚會
  - 靈恩會
  - 佈道會
- **時段分類**：
  - 上午
  - 下午
  - 晚上

### 3. 資料管理功能
- **資料輸入**：直覺化介面，支援多種日期格式，自動產生星期資訊  
- **資料查詢**：可依日期範圍、聚會類別（支援複選）和時段查詢  
- **資料統計**：自動統計各類聚會平均出席人數  
- **資料修改**：可依日期修改既有聚會記錄  
- **資料整合**：所有聚會記錄儲存於單一資料庫檔案  
- **資料自動修復**：系統自動檢測並修正資料欄位錯誤，確保資料一致性

### 4. 自動修復功能說明
#### 功能背景
在早期系統開發或資料輸入過程中，部分資料可能出現欄位存放錯置的情況（如「星期幾」誤存於聚會類別欄位）。為解決此問題，系統實作了自動修復功能。

#### 運作原理
- **自動檢測**：系統會自動檢查每筆新增或更新的資料是否存在結構問題  
- **無縫修復**：當檢測到問題時，系統會自動調整資料至正確欄位  
- **透明運作**：修復過程在背景執行，使用者無需干預

#### 修復項目
- 糾正「星期幾」與「聚會類別」欄位錯置問題  
- 確保「時間段」欄位存放正確資料  
- 維護資料庫結構一致性

### 5. 資料庫結構
資料表名稱：`count`  
包含欄位：

| 欄位名稱        | 說明           |
|-----------------|----------------|
| id              | 主鍵，自動編號 |
| date            | 日期           |
| meeting_type    | 聚會類別       |
| time_period     | 時間段         |
| week            | 星期           |
| topic           | 主題           |
| hymn1           | 讚美詩1        |
| hymn2           | 讚美詩2        |
| leader          | 主領           |
| translator      | 翻譯           |
| brother         | 弟兄人數       |
| sister          | 姊妹人數       |
| male_seeker     | 男性慕道者     |
| female_seeker   | 女性慕道者     |
| total_believer  | 主內總人數     |
| total_seeker    | 慕道者總人數   |
| total           | 總人數         |

## 使用指南

### 聚會記錄輸入
1. 在「聚會記錄輸入」頁籤中填寫各項資料  
2. 輸入日期後會自動生成星期幾  
3. 從下拉選單選擇聚會類別和時段  
4. 輸入弟兄、姊妹、慕道者人數後會自動計算總數  
5. 點擊「儲存」按鈕保存記錄  
6. 系統會自動檢查並修正資料結構問題（無需使用者操作）  

### 聚會記錄查詢
1. 進入「聚會記錄查詢」頁籤  
2. 設定查詢條件（日期範圍、聚會類別、時段）  
3. 點擊「查詢」按鈕顯示結果  
4. 查詢結果下方會顯示按聚會類別分類的統計資料  

### 聚會記錄修改
1. 進入「修改聚會記錄」頁籤  
2. 輸入要修改的聚會日期  
3. 點擊「載入」按鈕載入該記錄  
4. 修改需要調整的資料  
5. 點擊「更新」按鈕儲存修改  
6. 系統會自動檢查並修正更新後的資料結構問題  

### 操作提示
- 日期格式支援：`YYYY-MM-DD`（如 2025-06-24）或 `YYYY/MM/DD`（如 2025/06/24）  
- 人數輸入時只需輸入弟兄、姊妹、男女慕道者人數，總數會自動計算  
- 查詢時可選擇多個聚會類別進行複合查詢  
- 統計結果會顯示每種聚會類別的平均出席人數  
- 修改記錄時必須輸入完整日期才能準確找到記錄  

## 系統需求
- 作業系統：Windows、macOS 或 Linux  
- Python 3.6 或更高版本  
- Tkinter 圖形介面庫（Python 標準庫）  
- SQLite3 資料庫（Python 標準庫）  

## 常見問題

**Q: 為什麼系統需要自動修復功能？**  
A: 為解決早期可能存在的資料結構問題，確保所有資料查詢和統計功能正常運作。

**Q: 自動修復會影響我的原始資料嗎？**  
A: 修復只會調整欄位存放位置，不會刪除或更改實際資料內容，確保資料完整性。

**Q: 如何知道我的資料是否已被修復？**  
A: 系統在背景自動處理，無需使用者確認。如果查詢功能正常運作，代表資料結構已正確。
