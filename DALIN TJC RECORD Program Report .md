# DALIN TJC 聚會記錄管理系統 - 綜合程式報告

## 1. 程式概述

「DALIN TJC RECORD」是一個專為教會聚會記錄管理設計的桌面應用程式，使用 Python 和 Tkinter 開發。本系統提供完整的聚會資料管理功能，包括記錄輸入、資料查詢、統計分析和記錄修改，便於教會團體追蹤和分析各類聚會的出席情況。

## 2. 功能說明

### 2.1 記錄輸入功能

* 支援輸入聚會日期、類別、時段、主題、讚美詩等基本信息
* 記錄出席人數，區分弟兄、姊妹和慕道者數量
* 自動計算總人數，包括主內信徒總數、慕道者總數和全部總數
* 根據日期自動生成星期資訊
* 提供備註功能，可記錄額外資訊

### 2.2 查詢統計功能

* 按日期範圍、聚會類別、時段等條件進行多維度查詢
* 顯示符合條件的所有記錄
* 自動統計並顯示不同聚會類別的平均人數
* 對勾選的聚會類別進行合併統計
* 支援清除查詢結果

### 2.3 修改刪除功能

* 根據日期查找並載入既有記錄
* 支援同一日期多場聚會的選擇
* 修改後自動更新資料庫
* 安全刪除功能，有確認防護機制
* 自動修復欄位錯誤的功能

## 3. 技術實現

### 3.1 開發環境

* 程式語言：Python 3.x
* GUI 框架：Tkinter
* 資料庫：SQLite3

### 3.2 架構設計

* 使用標籤頁(Notebook)設計分離功能區塊
* 資料驗證和處理邏輯分離
* 事件驅動的用戶介面
* 使用參數化 SQL 查詢增強安全性

### 3.3 關鍵技術點

* 使用動態 SQL 語句構建複雜查詢
* 資料類型轉換與驗證
* 日期格式處理和星期自動生成
* 彈性的聚會類型和時間區段管理
* 多層級統計計算

## 4. 資料庫設計

### 4.1 資料表結構（count）

* id（主鍵，自動編號）
* date（日期）
* meeting\_type（聚會類別）
* time\_period（時間段）
* week（星期）
* topic（主題）
* hymn1, hymn2（讚美詩）
* leader（主領）
* translator（翻譯）
* brother, sister, male\_seeker, female\_seeker（人數統計）
* total\_believer, total\_seeker, total（自動計算）
* remarks（備註）

### 4.2 資料關係

* 以日期(date)與聚會類別(meeting\_type)標識記錄
* 使用時間段(time\_period)區分同日不同聚會
* 自動計算：

  * total\_believer = brother + sister
  * total\_seeker = male\_seeker + female\_seeker
  * total = total\_believer + total\_seeker

## 5. 使用者介面設計

### 5.1 介面結構

* 主視窗分為三大分頁：輸入、查詢、修改
* 使用 `LabelFrame` 組織各分頁內功能
* 結構化表單佈局，簡潔易用

### 5.2 特殊功能

* 多筆記錄選擇對話框（同一日多場聚會）
* 查詢結果使用 `Treeview` 呈現，數字欄靠右對齊
* 統計結果區為可滾動 `Text` 區塊
* 所有操作有明確反饋與提示訊息

## 6. 程式優點

### 6.1 功能完整

* 涵蓋聚會記錄管理的全流程
* 詳細分類與統計各類人數
* 查詢與統計功能靈活可擴充

### 6.2 使用者友善

* 操作直觀、流程清晰
* 支援自動欄位計算
* 提供輸入錯誤提示與防呆設計

### 6.3 資料安全

* SQL 參數化查詢防止注入攻擊
* 嚴格檢查資料型別
* 核心操作皆具備錯誤處理與回滾機制

### 6.4 維護性高

* 程式模組分明、可讀性強
* 註解充足
* 異常處理完善

## 7. 問題修復與改進建議

### 7.1 已修正問題摘要

| 問題類型        | 描述                        | 解決方式              |
| ----------- | ------------------------- | ----------------- |
| 資料表欄位錯誤     | remarks 欄位缺逗號未建立成功        | 修正建表語法並補建欄位       |
| global 宣告衝突 | 函式內重複宣告 global 變數         | 移除重複或錯誤宣告位置       |
| 區域變數未定義     | `correct_time_period` 未定義 | 增加預設值與條件處理        |
| 同日多場聚會      | 查詢與載入資料不準確                | 增加選擇視窗與以 ID 為準標識  |
| UI 顯示問題     | Treeview 欄位未對齊            | 統一欄位格式與寬度設置       |
| 備註需求        | 無備註欄位與輸入框                 | 增加 Text 欄位與 DB 欄位 |
| 刪除功能        | 無法刪除記錄                    | 實作刪除與確認機制         |

### 7.2 改進建議

* **功能擴充**：圖表化報表、匯出 CSV/Excel、資料庫備份/還原
* **使用者體驗**：加入日曆選擇器、現代化主題、快捷鍵、主題切換
* **程式優化**：面向物件重構、單元測試、資料查詢效率優化
* **安全性與日誌**：新增日誌記錄與異常捕捉
* **互動優化**：查詢結果雙擊跳轉至修改頁、自動捲動視窗顯示完整訊息

## 8. 結論

「DALIN TJC RECORD」聚會記錄系統成功提供了教會聚會資料的記錄、查詢、統計與管理功能。其結構清晰、操作簡易，且不斷優化後能進一步成為教會管理的數據核心系統。未來可持續加入備份、圖表、深度分析等功能，以強化教會數位管理能力。

> 報告日期：2025 年 6 月 24 日
